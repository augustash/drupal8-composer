"use strict";!function(l,w,p){var v=[];w.behaviors.exoEntityBrowserView={attach:function(e,t){var i=l(".entity-browser-form");i.addClass("exo-entity-browser-view exo-no-animations");var n=i.attr("data-entity-browser-uuid"),r=l("#ief-dropzone-upload");if(!r.length||(r.children().length?(i.find(".js-form-type-dropzonejs").hide(),l("#edit-actions").show()):(r.hide(),l("#edit-actions").hide()),w.views)){var s=w.views.instances[_.keys(w.views.instances)[0]];if(n&&s.$view.once("exo.entity-browser.view")){var a=parent&&parent.drupalSettings&&parent.drupalSettings.entity_browser&&parent.drupalSettings.entity_browser[n]?parent.drupalSettings.entity_browser[n].cardinality:-1,c=p.entity_browser_widget&&p.entity_browser_widget.auto_select;if(c){s.$view.find(".views-field-entity-browser-select").show().parent().once("unbind-register-row-click").off("click").once("register-row-click");var o=i.find(".entities-list-actions");o.length||(o=l('<div class="entities-list-actions" />').appendTo(i));var d=i.find(".entity-browser-use-selected, .entity-browser-show-selection").once("exo.entity-browser.view");d.length&&(o.empty(),d.appendTo(o))}parent&&parent.drupalSettings&&parent.drupalSettings.entity_browser&&parent.drupalSettings.entity_browser[n]&&parent.drupalSettings.entity_browser[n].entities&&parent.drupalSettings.entity_browser[n].entities.forEach(function(e){var t=s.$view.find('input[value="'+e+'"]');t.length&&(t.prop("disabled",!0),t.closest(".views-field-entity-browser-select").parent().addClass("disabled checked"))}),v.forEach(function(e){var t=s.$view.find('input[value="'+e+'"]');t.length&&(t.closest(".views-field-entity-browser-select").parent().addClass("checked"),t.prop("checked",!0))}),s.$view.find(".views-field-entity-browser-select").parent().once("exo.entity-browser.view").each(function(){var e=l(this),t=e.find(".views-field-entity-browser-select");l('<div class="exo-entity-browser-check"><svg class="exo-entity-browser-checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52"><circle class="exo-entity-browser-checkmark--circle" cx="26" cy="26" r="25" fill="none"/><path class="exo-entity-browser-checkmark--check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/></svg></div>').appendTo(t),t.find("input").prop("checked")&&e.addClass("checked")}).on("click.exo.entity-browser.view",function(e){e.preventDefault();var t=".views-field-entity-browser-select input",i=l(this),n=i.find(t),r=!n.prop("checked");if(n.prop("checked",r),r){if(e.preventDefault(),0<a){var s=l("tr.checked");s.length>=a&&(s.first().removeClass("checked").addClass("unchecked"),s.first().find(t).prop("disabled",!1).prop("checked",!1))}c&&n.prop("disabled",!0),i.removeClass("unchecked").addClass("checked"),v.push(n.val())}else c&&n.prop("disabled",!1),i.removeClass("checked").addClass("unchecked"),v=v.filter(function(e){return e!==n.val()});if(c)if(r)i.parents("form").find(".entities-list").trigger("add-entities",[[n.val()]]);else{var o=String(n.val()).split(":");i.parents("form").find(".entities-list").find('[data-entity-id="'+o[1]+'"] .entity-browser-remove-selected-entity').trigger("click")}}),i.find(".entities-list .entity-browser-remove-selected-entity").once("exo.entity-browser.view").on("click.exo.entity-browser.view",function(e){var t=l(this).attr("data-remove-entity").replace(/^\D+/g,""),i=s.$view.find('input[value$="'+t+'"]');i.length&&(i.prop("checked",!1),i.closest(".views-field-entity-browser-select").parent().removeClass("checked"),v=v.filter(function(e){return e!==i.val()}))}),setTimeout(function(){i.removeClass("exo-no-animations")},300),s.$view.hasClass("exo-entity-browser-grid")&&this.attachGrid(s)}}},attachGrid:function(e){e.$view.find(".views-row").once("exo-entity-browser-view").each(function(){var e=l(this),t=l('<div class="exo-entity-browser-info" />').appendTo(e);l(".views-field",e).each(function(e){l(this).find("img, input").length||l(this).appendTo(t)})})}}}(jQuery,Drupal,drupalSettings);