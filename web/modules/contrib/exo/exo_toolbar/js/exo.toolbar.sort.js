"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var o=0;o<e.length;o++){var a=e[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function _createClass(t,e,o){return e&&_defineProperties(t.prototype,e),o&&_defineProperties(t,o),t}!function(n,t,s){var e=new(function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"attach",value:function(t){var o=this;this.toolbar=t,this.$sortables=this.getSortables(t),this.$sections=t.getSections().elements();this.toolbar.getSection("left:top");this.$sortables.addClass("exo-toolbar-sortable"),this.$sections.sortable({items:".exo-toolbar-sortable",connectWith:".exo-toolbar-section",placeholder:"exo-toolbar-sort-placeholder",forcePlaceholderSize:!0,tolerance:"pointer",helper:"clone",forceHelperSize:!0,appendTo:n("body"),opacity:.9,scroll:!1,cursor:"move",start:function(t,e){return o.onSortableStart(t,e)},stop:function(t,e){return o.onSortableStop(t,e)},update:function(t,e){return o.onSortableUpdate(t,e)}}),this.$sortables.disableSelection()}},{key:"getSortables",value:function(t){var e=[];return t.getItems().each(function(t){t.allowSort()&&e.push(t.getSelector())}),n(e.join(", "))}},{key:"onSortableStart",value:function(t,e){this.$sections.each(function(t,e){var o=n(e).find(".exo-toolbar-create");n(e).css({minHeight:o.outerHeight(),minWidth:o.outerWidth()})}),this.toolbar.getElement().addClass("exo-toolbar-sorting"),this.toolbar.disableAsides()}},{key:"onSortableStop",value:function(t,e){this.$sections.css({minHeight:"",minWidth:""}),this.toolbar.getElement().removeClass("exo-toolbar-sorting"),this.toolbar.enableAsides(),this.toolbar.positionAsides()}},{key:"onSortableUpdate",value:function(t,e){var o=n(t.target).data("exo-section-id"),a=this.toolbar.getItem(e.item.data("exo-item-id")),i=this.toolbar.getSection(e.item.closest(".exo-toolbar-section").data("exo-section-id"));if(a&&i&&i.getId()===o){a.setSectionId(i.getBaseId()),a.setRegionId(i.getRegionId()),i.orderItems();var r=i.getItems();n.ajax({url:s.url("api/exo/toolbar/items/update"),type:"POST",data:JSON.stringify(r.getData()),dataType:"json",success:function(t){}})}}}]),t}());s.behaviors.exoToolbarSort={attach:function(t){s.ExoToolbar.isAdminMode()&&s.ExoToolbar.isReady().then(function(t){t.each(function(t){e.attach(t)})})}}}(jQuery,_,Drupal,drupalSettings);