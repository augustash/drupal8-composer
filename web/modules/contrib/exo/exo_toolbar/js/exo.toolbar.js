"use strict";function _get(e,t,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=_superPropBase(e,t);if(o){var i=Object.getOwnPropertyDescriptor(o,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ExoDataToolbar=function(){function o(e,t){var n;return _classCallCheck(this,o),(n=_possibleConstructorReturn(this,_getPrototypeOf(o).call(this,e))).exoToolbar=t,n}return _inherits(o,ExoData),_createClass(o,[{key:"getToolbar",value:function(){return this.exoToolbar}},{key:"getToolbarId",value:function(){return this.getToolbar().getId()}},{key:"getElement",value:function(){return this.$element||(this.$element=jQuery(this.getSelector())),this.$element}}]),o}();!function(a,l,u,e,r){var t=function(){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,_getPrototypeOf(e).apply(this,arguments))}return _inherits(e,ExoDataCollection),_createClass(e,[{key:"getNonEmpty",value:function(){var t=new e;return this.each(function(e){e.getElement().find(".exo-toolbar-element:not(.exo-toolbar-element-dependent)").length&&t.add(e)}),t}},{key:"getEmpty",value:function(){var t=new e;return this.each(function(e){e.getElement().find(".exo-toolbar-element:not(.exo-toolbar-element-dependent)").length||t.add(e)}),t}},{key:"getVisible",value:function(){var t=new e;return this.getNonEmpty().each(function(e){e.isHidden()||t.add(e)}),t}},{key:"getHidden",value:function(){var t=new e;return this.each(function(e){e.isHidden()&&t.add(e)}),t}},{key:"getVisibleByDefault",value:function(){var t=new e;return this.each(function(e){e.isHiddenByDefault()||t.add(e)}),t}},{key:"getHiddenByDefault",value:function(){var t=new e;return this.each(function(e){e.isHiddenByDefault()&&t.add(e)}),t}},{key:"getByEdge",value:function(t){var n=new e;return this.each(function(e){e.getEdge()===t&&n.add(e)}),n}},{key:"getByAlignment",value:function(t){var n=new e;return this.each(function(e){e.getAlignment()===t&&n.add(e)}),n}},{key:"getEdges",value:function(){var t=[];return this.each(function(e){l.contains(t,e.getEdge())||t.push(e.getEdge())}),t}}]),e}(),s=function(){function i(){var e;return _classCallCheck(this,i),(e=_possibleConstructorReturn(this,_getPrototypeOf(i).apply(this,arguments))).label="Toolbar Region",e.doDebug=!1,e.is_hidden=!1,e.is_expanded=!1,e.initialSize=null,e.events={show:new ExoEvent,shown:new ExoEvent,hide:new ExoEvent,hidden:new ExoEvent,expand:new ExoEvent,expanded:new ExoEvent,contract:new ExoEvent,contracted:new ExoEvent},e.positionLocked=!1,e.zIndexOffset=0,e.zIndexIsLocked=!1,e.zindexDepth={DEFAULT:100,HOVER:110,PARENT:115,FOCUSED:120},e}return _inherits(i,ExoDataToolbar),_createClass(i,[{key:"build",value:function(n){var o=this;return new Promise(function(t,e){_get(_getPrototypeOf(i.prototype),"build",o).call(o,n).then(function(e){o.is_hidden=o.get("hidden"),o.is_expanded=o.get("expanded"),o.isHidden()&&o.hide(!1,!0),o.bind(),t(e)},e)})}},{key:"bind",value:function(){var t,n=this;this.getElement().off("mouseenter.exo.toolbar.region").on("mouseenter.exo.toolbar.region",function(e){n.getToolbar().zIndexRegionEdge(n.getEdge(),"HOVER")}).off("mouseleave.exo.toolbar.region").on("mouseleave.exo.toolbar.region",function(e){n.getToolbar().zIndexRegionEdge(n.getEdge())}),"vertical"!==this.getAlignment()||u.ExoToolbar.isAdminMode()||this.getElement().off("mouseenter.exo.toolbar.region.vertical").on("mouseenter.exo.toolbar.region.vertical",function(e){e.preventDefault(),t=setTimeout(function(){n.expand()},200)}).off("mouseleave.exo.toolbar.region.vertical").on("mouseleave.exo.toolbar.region.vertical",function(e){e.preventDefault(),clearTimeout(t)})}},{key:"getSelector",value:function(){return"#exo-toolbar-region-".concat(this.getToolbarId(),"-").concat(this.getId()).replace(/_/g,"-").replace(/:/g,"")}},{key:"getEdge",value:function(){return this.get("edge")}},{key:"getAlignment",value:function(){return this.get("alignment")}},{key:"hasActiveItems",value:function(){var n=this;return new Promise(function(t,e){n.getToolbar().getItemsByRegion(n.getId()).each(function(e){e.getElement().hasClass(n.getToolbar().itemActiveClass)&&t(!0)}),t(!1)})}},{key:"getSize",value:function(){var e;switch(this.getAlignment()){case"horizontal":e=this.getElement().outerHeight();break;case"vertical":e=this.getElement().outerWidth()}return null===this.initialSize&&(this.initialSize=e),e}},{key:"getInitialSize",value:function(){return null!==this.initialSize&&0!==this.initialSize||(this.initialSize=this.getSize()),this.initialSize}},{key:"getOffset",value:function(){switch(this.getEdge()){case"top":return this.getElement().offset().top-a(window).scrollTop();case"left":return this.getElement().offset().left-a(window).scrollLeft();case"right":return a(window).width()-(this.getElement().offset().left-a(window).scrollLeft()+this.getSize());case"bottom":return a(window).height()-(this.getElement().offset().top-a(window).scrollTop()+this.getSize())}}},{key:"getEdgeOffsetsByEdge",value:function(){return this.getToolbar().getEdgeOffsetsByEdge(this.getEdge())}},{key:"getEdgeOffsetsByAlignment",value:function(){return this.getToolbar().getEdgeOffsetsByAlignment(this.getAlignment())}},{key:"getTransitionCss",value:function(){var t=[];return["left","top","right","bottom","width","height"].forEach(function(e){t.push(e+" "+u.Exo.speed+"ms")}),t.join(",")}},{key:"show",value:function(i,s){var r=this;return new Promise(function(t,e){if(!0===s||!0===r.is_hidden){r.getToolbar().setTransitionLock(!0),r.event("show").trigger(r),r.getToolbar().event("regionShow").trigger(r),r.getElement().off(u.Exo.whichTransitionEvent());var n={visibility:"visible",opacity:1,transition:"none"},o=r.getToolbar().getRegionSizeByEdge(r.getEdge());!0===i?(r.getElement().one(u.Exo.transitionEvent,function(e){r.shown(),t()}),n[r.getEdge()]=o+-1*r.getSize(),setTimeout(function(){n[r.getEdge()]=o,n.transition=r.getTransitionCss(),r.getElement().css(n)},40)):(r.shown(),n[r.getEdge()]=o,r.getElement().css(n),t())}})}},{key:"shown",value:function(){return this.is_hidden=!1,this.getToolbar().setTransitionLock(!1),this.event("shown").trigger(this),this}},{key:"hide",value:function(i,t){var s=this;return new Promise(function(o,e){!0===t||!1===s.is_hidden?(s.getToolbar().setTransitionLock(!0),s.contract().then(function(e){s.event("hide").trigger(s),s.getToolbar().event("regionHide").trigger(s);var t={},n={visibility:"hidden",opacity:0,transition:"none",zIndex:1};!0===i?(s.getElement().one(u.Exo.transitionEvent,function(e){s.hidden(),s.getElement().css(n),o(!0)}),t.visibility="visible",t.opacity=1,t.transition=s.getTransitionCss()):(s.hidden(),t=n,o(!0)),t[s.getEdge()]=-1*s.getSize(),s.getElement().css(t)})):o(!1)})}},{key:"hidden",value:function(){return this.is_hidden=!0,this.getToolbar().setTransitionLock(!1),this.event("hidden").trigger(this),this}},{key:"zIndexSet",value:function(e){return!1===this.zIndexIsLocked&&this.getElement().css("z-index",this.zIndexGet(e)),this}},{key:"zIndexGet",value:function(e){var t=e&&void 0!==this.zindexDepth[e]?this.zindexDepth[e]:this.zindexDepth.DEFAULT;return parseInt(t)+this.zIndexOffset}},{key:"zIndexSetOffset",value:function(e){return this.zIndexOffset=e,this}},{key:"zIndexLock",value:function(e){return this.zIndexIsLocked=!0===e,this}},{key:"positionLock",value:function(e){return this.positionLocked=!0===e,this}},{key:"isPositionLocked",value:function(){return this.positionLocked}},{key:"isHiddenByDefault",value:function(){return!u.ExoToolbar.isAdminMode()&&!0===this.get("hidden")}},{key:"isHidden",value:function(){return!u.ExoToolbar.isAdminMode()&&!0===this.is_hidden}},{key:"isExpandedByDefault",value:function(){return!0===this.get("expanded")}},{key:"isExpanded",value:function(){return!0===this.is_expanded}},{key:"expand",value:function(n){var o=this;return new Promise(function(t,e){!0===n||!1===o.is_expanded?o.isExpandedByDefault()||"vertical"!==o.getAlignment()?t(!1):(o.getToolbar().setTransitionLock(!0),o.is_expanded=!0,o.event("expand").trigger(o),o.getToolbar().event("regionExpand").trigger(o),o.getElement().one(u.Exo.transitionEvent,function(e){o.getToolbar().setTransitionLock(!1),o.event("expanded").trigger(o),t(!0)}),o.getElement().addClass(o.getToolbar().regionExpandedClass),o.isHiddenByDefault()||u.Exo.showShadow({opacity:.3,onClick:function(e){o.contract()}})):t(!1)})}},{key:"contract",value:function(n){var o=this;return new Promise(function(t,e){!0===n||!0===o.is_expanded?o.isExpandedByDefault()||"vertical"!==o.getAlignment()?t(!1):(o.getToolbar().setTransitionLock(!0),o.is_expanded=!1,o.isHiddenByDefault()&&t(!0),o.event("contract").trigger(o),o.getToolbar().event("regionContract").trigger(o),o.getElement().one(u.Exo.transitionEvent,function(e){o.getToolbar().setTransitionLock(!1),o.event("contracted").trigger(o),o.isHiddenByDefault()||t(!0)}),o.getElement().removeClass(o.getToolbar().regionExpandedClass),o.isHiddenByDefault()||u.Exo.hideShadow()):t(!1)})}}]),i}(),g=function(){function t(){var e;return _classCallCheck(this,t),(e=_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))).label="Toolbar Section",e.doDebug=!1,e}return _inherits(t,ExoDataToolbar),_createClass(t,[{key:"getBaseId",value:function(){return this.get("id")}},{key:"getSelector",value:function(){return"#exo-toolbar-section-".concat(this.getToolbarId(),"-").concat(this.getRegionId(),"-").concat(this.getBaseId()).replace(/_/g,"-").replace(/:/g,"")}},{key:"getRegionId",value:function(){return this.get("region")}},{key:"getRegion",value:function(){return this.getToolbar().getRegion(this.getRegionId())}},{key:"getItems",value:function(){return this.getToolbar().getItemsBySection(this.getId())}},{key:"orderItems",value:function(){var s=this,r=this.getItems();return r.elements().each(function(e,t){var n=a(t),o=n.data("exo-item-id"),i=r.getById(o);i&&(i.allowSort()?i.setWeight(e):"asc"===s.getSort()&&n.appendTo(s.getElement()))}),this}},{key:"getSort",value:function(){return this.get("sort")}}]),t}(),c=function(){function i(){var e;return _classCallCheck(this,i),(e=_possibleConstructorReturn(this,_getPrototypeOf(i).apply(this,arguments))).label="Toolbar Item",e.doDebug=!1,e}return _inherits(i,ExoDataToolbar),_createClass(i,[{key:"build",value:function(n){var o=this;return new Promise(function(t,e){_get(_getPrototypeOf(i.prototype),"build",o).call(o,n).then(function(e){null!==e&&o.bind(),t(e)},e)})}},{key:"bind",value:function(){this.getElement().off("mouseenter.exo.toolbar.region").on("mouseenter.exo.toolbar.region",function(e,t){a(t).css("z-index",1)}).off("mouseleave.exo.toolbar.region").on("mouseleave.exo.toolbar.region",function(e,t){a(t).css("z-index","")})}},{key:"getSelector",value:function(){return"#exo-toolbar-item-".concat(this.getId()).replace(/_/g,"-").replace(/:/g,"")}},{key:"getRegionId",value:function(){return this.get("region")}},{key:"setRegionId",value:function(e){return this.set("region",e),this}},{key:"getRegion",value:function(){return this.getToolbar().getRegion(this.getRegionId())}},{key:"getSectionId",value:function(){return this.get("section")}},{key:"getSectionUniqueId",value:function(){return this.getRegionId()+":"+this.getSectionId()}},{key:"setSectionId",value:function(e){return this.set("section",e),this}},{key:"getSection",value:function(){return this.getToolbar().getSection(this.getSectionUniqueId())}},{key:"allowSort",value:function(){return this.get("allow_sort")}},{key:"allowAdmin",value:function(){return this.get("allow_admin")}},{key:"getEdge",value:function(){return this.getRegion().getEdge()}},{key:"getAlignment",value:function(){return this.getRegion().getAlignment()}},{key:"disableAside",value:function(){return this.getElement().addClass(this.getToolbar().asideDisableClass),this}},{key:"enableAside",value:function(){return this.getElement().removeClass(this.getToolbar().asideDisableClass),this}},{key:"getPositionId",value:function(){return this.getEdge()+":"+this.getPositionOffsetProperty(this.getAlignment())}},{key:"getPositionOffsetProperty",value:function(e){var t=this.getEdge();switch(e){case"horizontal":switch(t){case"top":case"bottom":return this.getElement().offset().left-a(window).scrollLeft()>a(window).width()/2?"right":"left";case"left":case"right":return t}break;case"vertical":switch(t){case"top":case"bottom":return t;case"left":case"right":return this.getElement().offset().top-a(window).scrollTop()>a(window).height()/2?"bottom":"top"}}}},{key:"getPositionOffsetValue",value:function(e,t,n,o){t=t||this.getElement(),n=n||a(window),o="position"===o?"position":"offset";var i=0,s=this.getPositionId();switch(e){case"horizontal":switch(s){case"top:left":case"bottom:left":i=t[o]().left-n.scrollLeft();break;case"top:right":case"bottom:right":i=n.width()-(t[o]().left-n.scrollLeft()+t.outerWidth());break;case"left:top":case"left:bottom":i=t[o]().left-n.scrollLeft()+t.outerWidth();break;case"right:top":case"right:bottom":i=n.width()-(t[o]().left-n.scrollLeft())}break;case"vertical":switch(s){case"top:left":case"top:right":i=t[o]().top-n.scrollTop()+t.outerHeight();break;case"bottom:left":case"bottom:right":i=n.height()-(t[o]().top-n.scrollTop());break;case"left:top":case"right:top":i=t[o]().top-n.scrollTop();break;case"left:bottom":case"right:bottom":i=n.height()-(t[o]().top-n.scrollTop()+t.outerHeight())}}return Math.round(100*i)/100}},{key:"positionAside",value:function(){var e=a("."+this.getToolbar().asideClass,this.getElement());if(e.length){e.removeAttr("style");var t={};switch(t[this.getPositionOffsetProperty("horizontal")]=this.getPositionOffsetValue("horizontal")+"px",t[this.getPositionOffsetProperty("vertical")]=this.getPositionOffsetValue("vertical")+"px",this.getAlignment()){case"horizontal":t["min-width"]=this.getElement().outerWidth();break;case"vertical":t["min-height"]=this.getElement().outerHeight()}e.css(t),e.attr("data-exo-toolbar-item-position",this.getPositionId())}return this}},{key:"positionLabels",value:function(){var s=this;this.getElement().find("> .exo-toolbar-element").each(function(e,t){var n=a(t),o=s.getElement().find("#"+n.attr("id")+"-label");if(o.length){s.getPositionId();var i={};switch(s.getAlignment()){case"horizontal":i[s.getPositionOffsetProperty("horizontal")]=s.getPositionOffsetValue("horizontal",n,s.getElement(),"position")+"px",i[s.getPositionOffsetProperty("vertical")]="0px";break;case"vertical":i[s.getPositionOffsetProperty("vertical")]=s.getPositionOffsetValue("vertical",n,s.getElement(),"position")+"px",i[s.getPositionOffsetProperty("horizontal")]="0px"}o.css(i)}})}}]),i}(),n=function(){function i(e){var t;return _classCallCheck(this,i),(t=_possibleConstructorReturn(this,_getPrototypeOf(i).call(this,e))).label="Toolbar",t.doDebug=!1,t.regions={},t.sections={},t.items={},t.regionZIndexLock={},t.transitionLock=!1,t.regionEmptyClass="exo-toolbar-region-empty",t.regionLastClass="exo-toolbar-region-last",t.regionFocusClass="exo-toolbar-region-focus",t.regionExpandedClass="exo-toolbar-region-expanded",t.itemActiveClass="exo-toolbar-item-active",t.asideClass="exo-toolbar-item-aside",t.asideDisableClass="exo-toolbar-aside-disable",t.events={regionShow:new ExoEvent,regionHide:new ExoEvent,regionExpand:new ExoEvent,regionContract:new ExoEvent},u.Exo.getBodyElement().addClass("has-exo-toolbar"),t}return _inherits(i,ExoData),_createClass(i,[{key:"build",value:function(t){var o=this;return new Promise(function(n,e){_get(_getPrototypeOf(i.prototype),"build",o).call(o,t).then(function(t){if(null!==t){o.debug("log","Build: Act","["+o.id+"]",t);var e=[];t.regions&&e.push(o._build("regions",t.regions,s)),t.sections&&e.push(o._build("sections",t.sections,g)),t.items&&e.push(o._build("items",t.items,c)),o.getElement().imagesLoaded(function(){Promise.all(e).then(function(e){n(t)})})}else n(t)},e)})}},{key:"_build",value:function(o,i,s){var r=this;return new Promise(function(t,e){var n=[];l.each(i,function(e,t){r[o][t]||(r[o][t]=new s(t,r),n.push(r[o][t].build(i[t])))}),r[o]=r._sortKeysBy(r[o],function(e,t){return e.getWeight()}),Promise.all(n).then(function(e){t(!0)})})}},{key:"resize",value:function(){this.debug("log","Resize"),this.hideRegions(),this.zIndexRegions(),this.positionRegions(),this.interlockRegions(),this.positionAsides(),this.positionDividers()}},{key:"getId",value:function(){return this.id}},{key:"getElement",value:function(){return a("#exo-toolbar-"+this.id)}},{key:"getRegions",value:function(){return new t(this.regions)}},{key:"getRegion",value:function(e){return this.getRegions().getById(e)}},{key:"getSections",value:function(){return new ExoDataCollection(this.sections)}},{key:"getSection",value:function(e){return this.getSections().getById(e)}},{key:"getItems",value:function(){return new ExoDataCollection(this.items)}},{key:"getItemsByRegion",value:function(t){var n=new ExoDataCollection;return this.getItems().each(function(e){e.getRegionId()===t&&n.add(e)}),n}},{key:"getItemsBySection",value:function(t){var n=new ExoDataCollection;return this.getItems().each(function(e){e.getSectionUniqueId()===t&&n.add(e)}),n}},{key:"getItem",value:function(e){return this.getItems().getById(e)}},{key:"getRegionSizeByEdge",value:function(e){var t=0;return this.getRegions().getVisible().getByEdge(e).each(function(e){t+=e.getSize()}),t}},{key:"getRegionEdges",value:function(e){var t=[],n=this.getRegions();return e&&(n=n.getVisible()),n.each(function(e){l.contains(t,e.getEdge())||t.push(e.getEdge())}),t}},{key:"getEdgeOffsetsByEdge",value:function(e){switch(e){case"top":case"bottom":return["left","right"];case"left":case"right":return["top","bottom"]}}},{key:"getEdgeOffsetsByAlignment",value:function(e){switch(e){case"horizontal":return["left","right"];case"vertical":return["top","bottom"]}}},{key:"getRegionElements",value:function(){var t=[];return this.getRegions().each(function(e){t.push(e.getSelector())}),a(t.join(", "))}},{key:"hideRegions",value:function(){var e=this.getRegions();return e.getNonEmpty().elements().removeClass(this.regionEmptyClass),e.getEmpty().elements().addClass(this.regionEmptyClass),this}},{key:"zIndexRegions",value:function(){var t=this;return this.getRegions().getEdges().forEach(function(e){t.zIndexRegionEdge(e)}),this}},{key:"zIndexRegionsReset",value:function(){var t=this;return this.getRegions().getEdges().forEach(function(e){t.getRegions().getByEdge(e).each(function(e){e.zIndexLock(!1)}),t.zIndexRegionEdge(e)}),this}},{key:"zIndexRegionEdge",value:function(e,t){var n=this.getRegions().getByEdge(e),o=n.count();return n.each(function(e){e.zIndexSetOffset(o),e.zIndexSet(t),o--}),this}},{key:"zIndexRegionEdgeLock",value:function(e,t){return this.getRegions().getByEdge(e).each(function(e){e.zIndexLock(t)}),this}},{key:"zIndexRegionIsLocked",value:function(e){return void 0!==this.regionZIndexLock[e]&&!0===this.regionZIndexLock[e]}},{key:"zIndexRegionLock",value:function(e){return this.regionZIndexLock[e]=!0,this}},{key:"zIndexRegionUnlock",value:function(e){return this.regionZIndexLock[e]=!1,this}},{key:"positionRegions",value:function(){var s=this;return this.getRegions().getEdges().forEach(function(n){var e=s.getRegions().getVisibleByDefault().getByEdge(n),o=0;e.elements().removeClass(s.regionLastClass);var i=0;e.each(function(e){var t=e.getElement();t.css(n,o),i+=e.getInitialSize(),t.attr("data-offset-"+n,i),o+=e.getSize(),u.Exo.getBodyElement().addClass("has-exo-toolbar-region-"+n)});var t=e.getLast();t&&t.getElement().addClass(s.regionLastClass)}),setTimeout(function(){r(!0)}),this}},{key:"positionDividers",value:function(){var s=this,e=this.getRegions().getVisibleByDefault().getEdges(),t={};return e.forEach(function(e){t[e]=s.getRegionSizeByEdge(e)}),this.getRegions().each(function(e){var t=e.getElement(),n=a(".exo-toolbar-region-divider",t),o=e.getEdge();n.removeAttr("style");var i={};s.getEdgeOffsetsByEdge(o).forEach(function(e){i[e]=20}),n.css(i)}),this}},{key:"interlockRegions",value:function(n){var a=this;return n="vertical"===n?"vertical":"horizontal",this.getRegions().getEdges().forEach(function(e){var t=0;a.getRegions().getByEdge(e).each(function(s){if(!s.isPositionLocked()){var r=t;s.getAlignment()===n&&(r-=1),s.getEdgeOffsetsByAlignment().forEach(function(e){for(var t=a.getRegions().getVisibleByDefault().getByEdge(e),n=null,o=s.isHidden()?t.count()-1:r;n=t.getByDelta(o),o-=1,null===n&&0<=o;);if(n){var i={};i[e]=n.getSize()+n.getOffset(),s.getElement().css(i)}}),t++}})}),this}},{key:"positionAsides",value:function(){return this.getItems().each(function(o){o.getElement().off("mouseenter.exo.toolbar.aside").on("mouseenter.exo.toolbar.aside",function(e){o.positionAside(),o.positionLabels(),o.getElement().addClass("is-hover")}).off("mouseleave.exo.toolbar.aside").on("mouseleave.exo.toolbar.aside",function(e){o.getElement().removeClass("is-hover")}).off("mouseover.exo.toolbar.aside").on("mouseover.exo.toolbar.aside",function(e){var t=a(e.target).closest(".exo-toolbar-element"),n=o.getElement().find("#"+t.attr("id")+"-label");o.getElement().find(".exo-toolbar-item-aside-label").removeClass("is-current"),n.length&&n.addClass("is-current")})}),this}},{key:"disableAsides",value:function(){return a("body").addClass(this.asideDisableClass),this}},{key:"enableAsides",value:function(){return a("body").removeClass(this.asideDisableClass),this}},{key:"getDisplacement",value:function(){var t=this,o=[],i={top:0,bottom:0,left:0,right:0};return new Promise(function(n,e){t.getRegions().each(function(n){o.push(n.hasActiveItems().then(function(e){var t=n.getSize()+n.getOffset();e&&t>i[n.getEdge()]&&(i[n.getEdge()]=t)}))}),Promise.all(o).then(function(e){for(var t in i)i.hasOwnProperty(t)&&0===i[t]&&(i[t]=r.offsets[t]);n(i)})})}},{key:"setTransitionLock",value:function(e){this.transitionLock=!0===e}},{key:"isTransitionLocked",value:function(){return!0===this.transitionLock}},{key:"_sortKeysBy",value:function(t,n){var e=l.sortBy(l.keys(t),function(e){return n?n(t[e],e):e});return l.object(e,l.map(e,function(e){return t[e]}))}}]),i}(),o=function(){function i(){var e;return _classCallCheck(this,i),(e=_possibleConstructorReturn(this,_getPrototypeOf(i).apply(this,arguments))).label="ExoToolbars",e.doDebug=!1,e.settingsGroup="exoToolbar",e.instanceSettingsGroup="toolbars",e.instanceClass=n,e}return _inherits(i,ExoDataManager),_createClass(i,[{key:"attach",value:function(n){var o=this;return new Promise(function(t,e){_get(_getPrototypeOf(i.prototype),"attach",o).call(o,n).then(function(e){!0===e&&o.resize(),t(e)})})}},{key:"isAdminMode",value:function(){return!0===e.exoToolbar.isAdminMode}},{key:"getDisplacement",value:function(){var n=this;return new Promise(function(t,e){n.getInstances().each(function(e){e.getDisplacement().then(function(e){t(e)})})})}},{key:"resize",value:function(){this.getInstances().each(function(e){e.resize()})}}]),i}();u.ExoToolbar=new o,u.ExoDisplace.event("calculate").on("exo.toolbar",function(e){u.ExoToolbar.getDisplacement().then(function(e){u.ExoDisplace.offsets=e,u.ExoDisplace.broadcast()})}),u.Exo.event("init").on("toolbar",function(){u.Exo.addInitWait(u.ExoToolbar.attach(document.body)),u.behaviors.exoToolbar={attach:function(e){u.ExoToolbar.attach(e)}}})}(jQuery,_,Drupal,drupalSettings,Drupal.displace);